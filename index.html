<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Cr√©ez gratuitement un CV professionnel en ligne avec OrienCampus. T√©l√©chargez en PDF ou Word.">
    <title>OrienCampus - G√©n√©rateur de CV en ligne</title>

    <!-- Styles -->
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --light: #ecf0f1;
            --dark: #34495e;
            --success: #2ecc71;
            --warning: #f39c12;
            --danger: #e74c3c;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        html, body { height: 100%; }
        body {
            background-color: #f9f9f9;
            color: #333;
            line-height: 1.6;
        }
        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }
        header {
            background-color: var(--primary);
            color: white;
            padding: 15px 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        .header-inner { display:flex; align-items:center; justify-content:space-between; gap:10px; }
        .logo { font-size: 22px; font-weight: bold; }
        .logo span { color: var(--secondary); }
        .btn {
            display: inline-block;
            background-color: var(--secondary);
            color: white;
            padding: 10px 20px;
            border-radius: 4px;
            text-decoration: none;
            font-weight: bold;
            cursor: pointer;
            border: none;
            font-size: 16px;
            transition: all 0.25s;
        }
        .btn:hover { background-color: #2980b9; transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
        .btn-outline {
            background: transparent;
            border: 2px solid var(--secondary);
            color: var(--secondary);
        }
        .btn-outline:hover { background: var(--secondary); color: white; }

        .btn-success { background-color: var(--success); }
        .btn-success:hover { background-color: #27ae60; }

        /* Pages */
        .page { display:none; min-height: calc(100vh - 80px); padding: 40px 0; }
        .page-active { display:block; animation: fadeIn 0.4s ease; }
        @keyframes fadeIn { from { opacity:0 } to { opacity:1 } }

        /* Landing */
        .hero { text-align:center; margin-top: 60px; }
        .hero h1 { font-size: 2.5rem; color: var(--primary); margin-bottom: 20px; }
        .hero p { font-size:1.1rem; max-width:700px; margin:0 auto 30px; color:#555; }

        .features { display:grid; grid-template-columns:repeat(auto-fit,minmax(240px,1fr)); gap:20px; margin-top:40px; }
        .feature-card { background:white; padding:20px; border-radius:8px; text-align:center; box-shadow:0 6px 18px rgba(0,0,0,0.04); transition:transform .25s; }
        .feature-card:hover { transform:translateY(-6px); }
        .feature-icon { font-size:36px; margin-bottom:12px; color:var(--secondary); }

        /* Templates */
        .templates-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(260px,1fr)); gap:20px; margin-top:30px; }
        .template-card { background:white; border-radius:10px; overflow:hidden; box-shadow:0 6px 18px rgba(0,0,0,0.06); cursor:pointer; transition:transform .2s; }
        .template-card:hover { transform:translateY(-6px); }
        .template-preview { height:200px; display:flex; align-items:center; justify-content:center; color:#777; border-bottom:1px solid #eee; background:linear-gradient(180deg,#fafafa,#f3f6f9); }

        /* Form */
        .form-section { background:white; padding:20px; border-radius:10px; box-shadow:0 6px 18px rgba(0,0,0,0.04); margin-bottom:20px; }
        .form-section h2 { color:var(--primary); margin-bottom:12px; font-size:18px; }
        .form-row { display:flex; gap:15px; }
        .form-row .form-group { flex:1; }
        .form-group { margin-bottom:12px; }
        .form-group label { display:block; margin-bottom:6px; font-weight:600; font-size:14px; }
        .form-group input, .form-group textarea, .form-group select {
            width:100%; padding:10px; border:1px solid #ddd; border-radius:6px; font-size:15px;
        }
        .form-group input:focus, .form-group textarea:focus {
            border-color:var(--secondary); outline:none; box-shadow:0 0 0 3px rgba(52,152,219,0.08);
        }
        .repeatable-list { margin-top:10px; }
        .repeatable-item { background:#fafafa; padding:12px; border-radius:8px; margin-bottom:12px; position:relative; border-left:4px solid var(--secondary); }
        .remove-item { position:absolute; top:8px; right:8px; background:var(--danger); color:white; border:none; width:26px; height:26px; border-radius:50%; cursor:pointer; font-size:14px; }
        .remove-item:hover { background:#c0392b; }
        textarea { min-height:80px; resize:vertical; }

        /* CV Preview */
        #cv-output { background:white; padding:30px; box-shadow:0 6px 26px rgba(0,0,0,0.08); max-width:900px; margin: 20px auto; font-size:15px; line-height:1.5; border-radius:8px; }
        #cv-output h1 { color:var(--primary); margin-bottom:6px; font-size:22px; }
        #cv-output h2 { color:var(--secondary); margin-top:18px; margin-bottom:8px; padding-bottom:6px; border-bottom:1px solid #f0f0f0; font-size:16px; }
        .contact-info { display:flex; flex-wrap:wrap; gap:10px; margin-bottom:10px; font-size:14px; color:#444; }
        .cv-section { margin-bottom:14px; }
        .cv-item { margin-bottom:10px; }
        .cv-item h4 { margin-bottom:6px; color:var(--dark); font-size:15px; }
        .skills-container { display:flex; flex-wrap:wrap; gap:8px; margin-top:8px; }
        .skill-tag { background:var(--light); padding:6px 10px; border-radius:20px; font-size:13px; }

        /* Footer */
        footer { background:var(--dark); color:white; padding:30px 0 20px; margin-top:40px; }
        .footer-content { display:flex; flex-wrap:wrap; justify-content:space-between; gap:20px; }
        .footer-section { flex:1; min-width:220px; }
        .footer-section h3 { color:var(--secondary); margin-bottom:10px; }
        .footer-section ul { list-style:none; }
        .footer-section ul li { margin-bottom:8px; color:#ddd; }

        /* Responsive */
        @media (max-width:900px) {
            .form-row { flex-direction:column; }
            .header-inner { flex-direction:column; gap:12px; }
            .hero h1 { font-size:1.8rem; }
            .template-preview { height:160px; }
        }
    </style>
</head>
<body>

<!-- LANDING -->
<section id="landing-page" class="page page-active">
    <header>
        <div class="container header-inner">
            <div class="logo">Orien<span>Campus</span></div>
            <div>
                <button class="btn" onclick="showPage('templates-page')">Cr√©er mon CV</button>
            </div>
        </div>
    </header>

    <div class="container">
        <div class="hero">
            <h1>Cr√©ez votre CV professionnel gratuitement</h1>
            <p>OrienCampus vous guide pas √† pas pour cr√©er un CV moderne, clair et efficace ‚Äî sans inscription.</p>
        </div>

        <div class="features">
            <div class="feature-card">
                <div class="feature-icon">üìÑ</div>
                <h3>CV Professionnels</h3>
                <p>Cr√©ez des CV attrayants qui impressionneront les recruteurs.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">üé®</div>
                <h3>Mod√®les Personnalisables</h3>
                <p>Choisissez parmi plusieurs designs adapt√©s √† votre profil.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">üì•</div>
                <h3>T√©l√©chargement Facile</h3>
                <p>Exportez votre CV en PDF en un clic.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">üöÄ</div>
                <h3>Rapide et Efficace</h3>
                <p>Cr√©ez votre CV professionnel en quelques minutes.</p>
            </div>
        </div>
    </div>
</section>

<!-- TEMPLATES -->
<section id="templates-page" class="page">
    <header>
        <div class="container header-inner">
            <div class="logo">Orien<span>Campus</span></div>
            <div>
                <button class="btn btn-outline" onclick="showPage('landing-page')">‚Üê Retour</button>
            </div>
        </div>
    </header>

    <div class="container">
        <h1 style="text-align:center; margin:24px 0; color:var(--primary)">Choisissez un mod√®le de CV</h1>
        <p style="text-align:center; color:#555; max-width:760px; margin:0 auto 20px;">S√©lectionnez le design qui correspond le mieux √† votre personnalit√© et √† votre secteur d'activit√©.</p>

        <div class="templates-grid">
            <div class="template-card" onclick="selectTemplate('classic')">
                <div class="template-preview">Aper√ßu ‚Äî Classique</div>
                <div style="padding:12px;">
                    <h3 style="margin-bottom:6px; color:var(--primary)">Mod√®le Classique</h3>
                    <p style="color:#555;">Design √©pur√© et professionnel, id√©al pour tous les secteurs.</p>
                </div>
            </div>
            <div class="template-card" onclick="selectTemplate('modern')">
                <div class="template-preview">Aper√ßu ‚Äî Moderne</div>
                <div style="padding:12px;">
                    <h3 style="margin-bottom:6px; color:var(--primary)">Mod√®le Moderne</h3>
                    <p style="color:#555;">Design contemporain avec couleurs et sections distinctes.</p>
                </div>
            </div>
            <div class="template-card" onclick="selectTemplate('executive')">
                <div class="template-preview">Aper√ßu ‚Äî Cadre</div>
                <div style="padding:12px;">
                    <h3 style="margin-bottom:6px; color:var(--primary)">Mod√®le Cadre</h3>
                    <p style="color:#555;">√âl√©gant et sophistiqu√©, parfait pour les postes de direction.</p>
                </div>
            </div>
            <div class="template-card" onclick="selectTemplate('creative')">
                <div class="template-preview">Aper√ßu ‚Äî Cr√©atif</div>
                <div style="padding:12px;">
                    <h3 style="margin-bottom:6px; color:var(--primary)">Mod√®le Cr√©atif</h3>
                    <p style="color:#555;">Id√©al pour les m√©tiers du design, marketing et communication.</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- FORM -->
<section id="form-page" class="page">
    <header>
        <div class="container header-inner">
            <div class="logo">Orien<span>Campus</span></div>
            <div>
                <button class="btn btn-outline" onclick="showPage('templates-page')">‚Üê Changer de mod√®le</button>
            </div>
        </div>
    </header>

    <div class="container" style="padding-top:18px;">
        <h1 style="text-align:center; margin:18px 0 22px; color:var(--primary)">Remplissez votre CV</h1>

        <form id="cv-form" onsubmit="event.preventDefault(); generatePreview();">
            <!-- Informations personnelles -->
            <div class="form-section">
                <h2>Informations personnelles</h2>
                <div class="form-row">
                    <div class="form-group">
                        <label for="nom">Nom complet *</label>
                        <input type="text" id="nom" required placeholder="Ex: Diarra Abdoul Dramane">
                    </div>
                    <div class="form-group">
                        <label for="poste">Poste vis√© *</label>
                        <input type="text" id="poste" required placeholder="Ex: Administrateur R√©seaux">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="email">Email *</label>
                        <input type="email" id="email" required placeholder="exemple@mail.com">
                    </div>
                    <div class="form-group">
                        <label for="tel">T√©l√©phone *</label>
                        <input type="tel" id="tel" required placeholder="+226 70 00 00 00">
                    </div>
                </div>

                <div class="form-group">
                    <label for="adresse">Adresse (facultatif)</label>
                    <input type="text" id="adresse" placeholder="Ville, Pays">
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="photo">Photo (URL, facultatif)</label>
                        <input type="url" id="photo" placeholder="https://exemple.com/photo.jpg">
                    </div>
                    <div class="form-group">
                        <label for="linkedin">Profil LinkedIn (facultatif)</label>
                        <input type="url" id="linkedin" placeholder="https://linkedin.com/in/votrenom">
                    </div>
                </div>
            </div>

            <!-- Profil -->
            <div class="form-section">
                <h2>Profil / R√©sum√© *</h2>
                <div class="form-group">
                    <label for="profil">D√©crivez-vous en quelques lignes (objectif, forces, exp√©rience cl√©)</label>
                    <textarea id="profil" required placeholder="Ex: Ing√©nieur r√©seau avec 3 ans d'exp√©rience..."></textarea>
                </div>
            </div>

            <!-- Exp√©rience -->
            <div class="form-section">
                <h2>Exp√©rience professionnelle</h2>
                <div id="experiences" class="repeatable-list">
                    <div class="repeatable-item">
                        <button type="button" class="remove-item" onclick="removeExperience(this)">√ó</button>
                        <div class="form-group"><label>Poste *</label><input type="text" class="exp-poste" required></div>
                        <div class="form-row">
                            <div class="form-group"><label>Entreprise *</label><input type="text" class="exp-entreprise" required></div>
                            <div class="form-group"><label>Ville</label><input type="text" class="exp-ville"></div>
                        </div>
                        <div class="form-row">
                            <div class="form-group"><label>D√©but (ex: 2020)</label><input type="text" class="exp-debut"></div>
                            <div class="form-group"><label>Fin (ex: 2023 ou Pr√©sent)</label><input type="text" class="exp-fin"></div>
                        </div>
                        <div class="form-group"><label>Description</label><textarea class="exp-desc"></textarea></div>
                    </div>
                </div>
                <div style="margin-top:8px;">
                    <button type="button" class="btn btn-outline" onclick="addExperience()">+ Ajouter une exp√©rience</button>
                </div>
            </div>

            <!-- Formation -->
            <div class="form-section">
                <h2>Formation</h2>
                <div id="formations" class="repeatable-list">
                    <div class="repeatable-item">
                        <button type="button" class="remove-item" onclick="removeFormation(this)">√ó</button>
                        <div class="form-group"><label>Dipl√¥me *</label><input type="text" class="formation-diplome" required></div>
                        <div class="form-row">
                            <div class="form-group"><label>√âtablissement *</label><input type="text" class="formation-etablissement" required></div>
                            <div class="form-group"><label>Ville</label><input type="text" class="formation-ville"></div>
                        </div>
                        <div class="form-row">
                            <div class="form-group"><label>D√©but</label><input type="text" class="formation-debut"></div>
                            <div class="form-group"><label>Fin</label><input type="text" class="formation-fin"></div>
                        </div>
                    </div>
                </div>
                <div style="margin-top:8px;">
                    <button type="button" class="btn btn-outline" onclick="addFormation()">+ Ajouter une formation</button>
                </div>
            </div>

            <!-- Comp√©tences -->
            <div class="form-section">
                <h2>Comp√©tences</h2>
                <div class="form-group">
                    <label>Comp√©tences (s√©par√©es par des virgules)</label>
                    <input type="text" id="competences" placeholder="Ex: Communication, Excel, Python">
                </div>
            </div>

            <!-- Langues -->
            <div class="form-section">
                <h2>Langues</h2>
                <div class="form-group">
                    <label>Langues (ex: Fran√ßais - Courant, Anglais - Interm√©diaire)</label>
                    <input type="text" id="langues" placeholder="Ex: Fran√ßais - Natif, Anglais - Technique">
                </div>
            </div>

            <!-- Centres d'int√©r√™t -->
            <div class="form-section">
                <h2>Centres d'int√©r√™t (facultatif)</h2>
                <div class="form-group">
                    <label>Ex: Lecture, Voyage, Basket, D√©veloppement web</label>
                    <input type="text" id="centres" placeholder="Ex: Lecture, Football">
                </div>
            </div>

            <!-- Actions -->
            <div style="display:flex; justify-content:space-between; gap:10px; align-items:center; margin-top:12px;">
                <button type="button" class="btn btn-outline" onclick="showPage('templates-page')">‚Üê Retour aux mod√®les</button>
                <div>
                    <button type="button" class="btn btn-outline" onclick="resetForm()">Tout effacer</button>
                    <button type="submit" class="btn btn-success">Voir l'aper√ßu du CV</button>
                </div>
            </div>
        </form>
    </div>
</section>

<!-- PREVIEW -->
<section id="preview-page" class="page">
    <header>
        <div class="container header-inner">
            <div class="logo">Orien<span>Campus</span></div>
            <div>
                <button class="btn btn-outline" onclick="showPage('form-page')">Modifier</button>
                <button class="btn" onclick="downloadPDF()">T√©l√©charger PDF</button>
            </div>
        </div>
    </header>

    <div class="container">
        <div id="cv-output" aria-live="polite"></div>

        <div style="display:flex; justify-content:center; gap:12px; margin-top:16px;">
            <button class="btn btn-outline" onclick="showPage('form-page')">‚Üê Modifier le CV</button>
            <button class="btn" onclick="downloadPDF()">T√©l√©charger en PDF</button>
            <button class="btn btn-success" onclick="shareCV()">Partager le CV</button>
        </div>
    </div>
</section>

<!-- FOOTER -->
<footer>
    <div class="container">
        <div class="footer-content">
            <div class="footer-section">
                <h3>OrienCampus</h3>
                <p>Plateforme de cr√©ation de CV en ligne, gratuite et facile √† utiliser.</p>
            </div>
            <div class="footer-section">
                <h3>Contact</h3>
                <ul>
                    <li>Email: contact@oriencampus.com</li>
                    <li>T√©l√©phone: +226 75 74 44 17</li>
                    <li>Adresse: Bobo-Dioulasso, Burkina Faso</li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>R√©seaux sociaux</h3>
                <ul>
                    <li><a href="#" style="color:#ddd; text-decoration:none;">Facebook</a></li>
                    <li><a href="#" style="color:#ddd; text-decoration:none;">Twitter</a></li>
                    <li><a href="#" style="color:#ddd; text-decoration:none;">LinkedIn</a></li>
                </ul>
            </div>
        </div>
        <div style="text-align:center; color:#ddd; margin-top:10px;">&copy; <span id="year"></span> OrienCampus. Tous droits r√©serv√©s.</div>
    </div>
</footer>

<!-- Script: html2pdf (CDN) pour export PDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>

<!-- JavaScript -->
<script>
    // √âtat global
    let currentTemplate = 'classic';

    // Initialisation
    document.getElementById('year').textContent = new Date().getFullYear();

    // Navigation pages
    function showPage(pageId) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('page-active'));
        const el = document.getElementById(pageId.replace('-page','') + '-page') || document.getElementById(pageId);
        // support both passing id exactly or with -page suffix
        if (el) el.classList.add('page-active');
        window.scrollTo(0,0);
    }

    function selectTemplate(template) {
        currentTemplate = template;
        showPage('form-page');
    }

    // Repeatables: Experiences
    function addExperience() {
        const container = document.getElementById('experiences');
        const item = document.createElement('div');
        item.className = 'repeatable-item';
        item.innerHTML = `
            <button type="button" class="remove-item" onclick="removeExperience(this)">√ó</button>
            <div class="form-group"><label>Poste *</label><input type="text" class="exp-poste" required></div>
            <div class="form-row">
                <div class="form-group"><label>Entreprise *</label><input type="text" class="exp-entreprise" required></div>
                <div class="form-group"><label>Ville</label><input type="text" class="exp-ville"></div>
            </div>
            <div class="form-row">
                <div class="form-group"><label>D√©but (ex: 2020)</label><input type="text" class="exp-debut"></div>
                <div class="form-group"><label>Fin (ex: 2023 ou Pr√©sent)</label><input type="text" class="exp-fin"></div>
            </div>
            <div class="form-group"><label>Description</label><textarea class="exp-desc"></textarea></div>
        `;
        container.appendChild(item);
    }
    function removeExperience(btn) {
        const items = document.querySelectorAll('#experiences .repeatable-item');
        if (items.length > 1) {
            btn.closest('.repeatable-item').remove();
        } else {
            alert("Vous devez conserver au moins une exp√©rience.");
        }
    }

    // Repeatables: Formations
    function addFormation() {
        const container = document.getElementById('formations');
        const item = document.createElement('div');
        item.className = 'repeatable-item';
        item.innerHTML = `
            <button type="button" class="remove-item" onclick="removeFormation(this)">√ó</button>
            <div class="form-group"><label>Dipl√¥me *</label><input type="text" class="formation-diplome" required></div>
            <div class="form-row">
                <div class="form-group"><label>√âtablissement *</label><input type="text" class="formation-etablissement" required></div>
                <div class="form-group"><label>Ville</label><input type="text" class="formation-ville"></div>
            </div>
            <div class="form-row">
                <div class="form-group"><label>D√©but</label><input type="text" class="formation-debut"></div>
                <div class="form-group"><label>Fin</label><input type="text" class="formation-fin"></div>
            </div>
        `;
        container.appendChild(item);
    }
    function removeFormation(btn) {
        const items = document.querySelectorAll('#formations .repeatable-item');
        if (items.length > 1) {
            btn.closest('.repeatable-item').remove();
        } else {
            alert("Vous devez conserver au moins une formation.");
        }
    }

    // Reset form (simple)
    function resetForm() {
        if (!confirm('Voulez-vous vraiment effacer tous les champs ?')) return;
        document.getElementById('cv-form').reset();
        // remove extra repeatables, keep only one of each
        document.querySelectorAll('#experiences .repeatable-item').forEach((el,i) => { if (i>0) el.remove(); });
        document.querySelectorAll('#formations .repeatable-item').forEach((el,i) => { if (i>0) el.remove(); });
        window.scrollTo(0,0);
    }

    // G√©n√©ration de l'aper√ßu
    function generatePreview() {
        const data = {
            nom: document.getElementById('nom').value.trim(),
            poste: document.getElementById('poste').value.trim(),
            email: document.getElementById('email').value.trim(),
            tel: document.getElementById('tel').value.trim(),
            adresse: document.getElementById('adresse').value.trim(),
            photo: document.getElementById('photo').value.trim(),
            linkedin: document.getElementById('linkedin').value.trim(),
            profil: document.getElementById('profil').value.trim(),
            competences: document.getElementById('competences').value.trim(),
            langues: document.getElementById('langues').value.trim(),
            centres: document.getElementById('centres').value.trim(),
            template: currentTemplate
        };

        data.experiences = [];
        document.querySelectorAll('#experiences .repeatable-item').forEach(item => {
            const exp = {
                poste: (item.querySelector('.exp-poste')?.value || '').trim(),
                entreprise: (item.querySelector('.exp-entreprise')?.value || '').trim(),
                ville: (item.querySelector('.exp-ville')?.value || '').trim(),
                debut: (item.querySelector('.exp-debut')?.value || '').trim(),
                fin: (item.querySelector('.exp-fin')?.value || '').trim(),
                desc: (item.querySelector('.exp-desc')?.value || '').trim()
            };
            if (exp.poste || exp.entreprise) data.experiences.push(exp);
        });

        data.formations = [];
        document.querySelectorAll('#formations .repeatable-item').forEach(item => {
            const f = {
                diplome: (item.querySelector('.formation-diplome')?.value || '').trim(),
                etablissement: (item.querySelector('.formation-etablissement')?.value || '').trim(),
                ville: (item.querySelector('.formation-ville')?.value || '').trim(),
                debut: (item.querySelector('.formation-debut')?.value || '').trim(),
                fin: (item.querySelector('.formation-fin')?.value || '').trim()
            };
            if (f.diplome || f.etablissement) data.formations.push(f);
        });

        // Validation
        if (!data.nom || !data.poste || !data.email || !data.tel || !data.profil) {
            alert('Veuillez remplir tous les champs obligatoires (Nom, Poste, Email, T√©l√©phone, Profil).');
            showPage('form-page');
            return;
        }

        renderCV(data);
        showPage('preview-page');
    }

    // √âchappe le texte pour √©viter injection HTML
    function escapeHtml(text) {
        if (!text && text !== 0) return '';
        return String(text)
            .replaceAll('&','&amp;')
            .replaceAll('<','&lt;')
            .replaceAll('>','&gt;')
            .replaceAll('"','&quot;')
            .replaceAll("'",'&#039;');
    }

    // Render CV HTML selon template
    function renderCV(data) {
        // d√©but du container selon template
        let wrapperStart = '<div>';
        let wrapperClass = '';
        if (data.template === 'modern') {
            wrapperStart = '<div style="display:flex; gap:20px; align-items:flex-start;">';
            wrapperClass = 'modern-template';
        } else if (data.template === 'executive') {
            wrapperStart = '<div style="background:#fbfbfc; padding:18px; border-radius:8px;">';
            wrapperClass = 'executive-template';
        } else if (data.template === 'creative') {
            wrapperStart = '<div style="border-top:4px solid var(--secondary); padding-top:12px;">';
            wrapperClass = 'creative-template';
        } else {
            wrapperStart = '<div>';
            wrapperClass = 'classic-template';
        }

        let html = '';
        html += wrapperStart;

        // Photo
        if (data.photo) {
            // try to include valid image, otherwise fallback to initials
            html += `<div style="text-align:center; margin-bottom:10px;"><img src="${escapeHtml(data.photo)}" alt="Photo" style="width:110px;height:110px;object-fit:cover;border-radius:50%;border:2px solid #eee;"></div>`;
        }

        // Header: Name & title
        html += `<h1 style="margin-bottom:4px;">${escapeHtml(data.nom)}</h1>`;
        html += `<div style="color:var(--secondary); font-weight:600; margin-bottom:8px;">${escapeHtml(data.poste)}</div>`;

        // Contact
        html += `<div class="contact-info">`;
        html += `<span>üìß ${escapeHtml(data.email)}</span>`;
        html += `<span>üì± ${escapeHtml(data.tel)}</span>`;
        if (data.adresse) html += `<span>üìç ${escapeHtml(data.adresse)}</span>`;
        if (data.linkedin) {
            const url = escapeHtml(data.linkedin);
            html += `<span>üîó <a href="${url}" target="_blank" rel="noopener noreferrer">${url}</a></span>`;
        }
        html += `</div>`;

        // Profil
        html += `<div class="cv-section"><h2>Profil</h2><p>${escapeHtml(data.profil).replaceAll('\n','<br>')}</p></div>`;

        // Exp√©riences
        if (data.experiences && data.experiences.length) {
            html += `<div class="cv-section"><h2>Exp√©rience professionnelle</h2>`;
            data.experiences.forEach(exp => {
                html += `<div class="cv-item">`;
                const locationPart = exp.ville ? `, ${escapeHtml(exp.ville)}` : '';
                html += `<h4>${escapeHtml(exp.poste)} ‚Äî ${escapeHtml(exp.entreprise)}${locationPart}</h4>`;
                if (exp.debut || exp.fin) {
                    html += `<p style="font-style:italic; color:#666; margin-bottom:6px;">${escapeHtml(exp.debut || '')}${exp.debut && exp.fin ? ' ‚Äì ' : ''}${escapeHtml(exp.fin || '')}</p>`;
                }
                if (exp.desc) html += `<p>${escapeHtml(exp.desc).replaceAll('\n','<br>')}</p>`;
                html += `</div>`;
            });
            html += `</div>`;
        }

        // Formations
        if (data.formations && data.formations.length) {
            html += `<div class="cv-section"><h2>Formation</h2>`;
            data.formations.forEach(f => {
                html += `<div class="cv-item">`;
                const locationPart = f.ville ? `, ${escapeHtml(f.ville)}` : '';
                html += `<h4>${escapeHtml(f.diplome)} ‚Äî ${escapeHtml(f.etablissement)}${locationPart}</h4>`;
                if (f.debut || f.fin) {
                    html += `<p style="font-style:italic; color:#666;">${escapeHtml(f.debut || '')}${f.debut && f.fin ? ' ‚Äì ' : ''}${escapeHtml(f.fin || '')}</p>`;
                }
                html += `</div>`;
            });
            html += `</div>`;
        }

        // Comp√©tences
        if (data.competences) {
            const skills = data.competences.split(',').map(s => s.trim()).filter(Boolean);
            if (skills.length) {
                html += `<div class="cv-section"><h2>Comp√©tences</h2><div class="skills-container">`;
                skills.forEach(s => { html += `<span class="skill-tag">${escapeHtml(s)}</span>`; });
                html += `</div></div>`;
            }
        }

        // Langues
        if (data.langues) {
            html += `<div class="cv-section"><h2>Langues</h2><p>${escapeHtml(data.langues)}</p></div>`;
        }

        // Centres d'int√©r√™t
        if (data.centres) {
            html += `<div class="cv-section"><h2>Centres d'int√©r√™t</h2><p>${escapeHtml(data.centres)}</p></div>`;
        }

        html += `</div>`; // ferme wrapper

        // Injecter HTML dans le preview
        document.getElementById('cv-output').innerHTML = html;

        // applique quelques styles inline selon template (am√©lioration visuelle)
        if (data.template === 'modern') {
            document.getElementById('cv-output').style.borderLeft = '6px solid var(--secondary)';
        } else {
            document.getElementById('cv-output').style.borderLeft = 'none';
        }
    }

    // T√©l√©charger en PDF (html2pdf)
    function downloadPDF() {
        const element = document.getElementById('cv-output');
        if (!element || !element.innerHTML.trim()) {
            alert('Aucun CV √† exporter. G√©n√©rez d‚Äôabord l‚Äôaper√ßu.');
            return;
        }

        const opt = {
            margin:       0.4,
            filename:     `CV-${(document.getElementById('nom').value || 'mon-cv').replaceAll(' ', '_')}.pdf`,
            image:        { type: 'jpeg', quality: 0.98 },
            html2canvas:  { scale: 2, useCORS: true },
            jsPDF:        { unit: 'in', format: 'a4', orientation: 'portrait' }
        };

        // show a small feedback
        const prevTxt = document.querySelector('button[onclick="downloadPDF()"]').textContent;
        document.querySelector('button[onclick="downloadPDF()"]').textContent = 'G√©n√©ration...';

        html2pdf().set(opt).from(element).save().then(() => {
            document.querySelector('button[onclick="downloadPDF()"]').textContent = prevTxt;
        }).catch(err => {
            console.error(err);
            alert('Erreur lors de la g√©n√©ration du PDF. Vous pouvez utiliser Ctrl+P ‚Üí Enregistrer en PDF comme alternative.');
            document.querySelector('button[onclick="downloadPDF()"]').textContent = prevTxt;
        });
    }

    // Partage natif si dispo
    function shareCV() {
        try {
            if (navigator.share) {
                navigator.share({
                    title: 'Mon CV - OrienCampus',
                    text: 'D√©couvrez mon CV cr√©√© avec OrienCampus',
                    url: window.location.href
                }).then(() => {}).catch(() => {});
            } else {
                // fallback: copy preview HTML to clipboard or show message
                copyToClipboard(document.getElementById('cv-output').innerText || '');
                alert('Aucun partage natif support√©. Le texte du CV a √©t√© copi√© dans le presse-papier.');
            }
        } catch (e) {
            console.error(e);
            alert('Impossible de partager sur ce navigateur.');
        }
    }

    // util: copy text to clipboard
    function copyToClipboard(text) {
        if (!navigator.clipboard) {
            const ta = document.createElement('textarea');
            ta.value = text;
            document.body.appendChild(ta);
            ta.select();
            document.execCommand('copy');
            document.body.removeChild(ta);
            return;
        }
        navigator.clipboard.writeText(text).catch(()=>{});
    }

    // Petit confort: charger un exemple (optionnel)
    (function loadExampleData(){
        // ne charge que si le formulaire est vide
        if (!document.getElementById('nom').value) {
            document.getElementById('nom').value = 'Diarra Abdoul Dramane';
            document.getElementById('poste').value = 'Administrateur R√©seaux';
            document.getElementById('email').value = 'exemple@mail.com';
            document.getElementById('tel').value = '+226 70 00 00 00';
            document.getElementById('profil').value = "Administrateur r√©seaux motiv√© avec exp√©rience en configuration de commutateurs, gestion de serveurs et s√©curit√© r√©seau.";
            document.getElementById('competences').value = 'Linux, Cisco, TCP/IP, Wireshark, Firewall';
            document.getElementById('langues').value = 'Fran√ßais - Natif, Anglais - Technique';
            // leave experiences/formations as placeholders (users can edit)
            document.querySelector('.exp-poste').value = 'Technicien R√©seau';
            document.querySelector('.exp-entreprise').value = 'Entreprise X';
            document.querySelector('.formation-diplome').value = 'BPTS - R√©seaux';
            document.querySelector('.formation-etablissement').value = 'Institut Y';
        }
    })();
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Générateur de CV - OrienCampus</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
    body { font-family: Arial, sans-serif; background:#f0f0f0; margin:0; padding:0; }
    .container { width: 95%; max-width: 900px; margin: 20px auto; background:white; padding:20px; border-radius:10px; }
    .page { display:none; }
    .active { display:block; }
    .btn { padding:10px 15px; border:none; background:#2b62ff; color:white; border-radius:8px; cursor:pointer; }
    .btn-outline { padding:10px 15px; border:1px solid #2b62ff; color:#2b62ff; background:white; border-radius:8px; cursor:pointer; }
    .form-group { margin-bottom:12px; }
    input { width:100%; padding:8px; border:1px solid #ccc; border-radius:6px; }
    .block { border:1px solid #ccc; padding:10px; margin-top:10px; border-radius:6px; background:#fafafa; }
    .remove-item { float:right; background:#ff3b3b; color:white; border:none; width:25px; height:25px; border-radius:50%; cursor:pointer; }
</style>
</head>

<body>

<div class="container">
    <h1>Générateur de CV - OrienCampus</h1>

    <!-- PAGE 1 -->
    <div id="page1" class="page active">
        <h2>Informations personnelles</h2>
        <div class="form-group"><label>Nom</label><input id="nom"></div>
        <div class="form-group"><label>Prénoms</label><input id="prenoms"></div>
        <div class="form-group"><label>Email</label><input id="email"></div>
        <div class="form-group"><label>Téléphone</label><input id="telephone"></div>
        <div class="form-group"><label>Adresse</label><input id="adresse"></div>
        
        <button class="btn" onclick="nextPage(1)">Suivant</button>
    </div>

    <!-- PAGE 2 -->
    <div id="page2" class="page">
        <h2>Votre parcours scolaire</h2>

        <h3>École primaire</h3>
        <div id="primaire"></div>
        <button class="btn-outline" onclick="addBlock('primaire')">+ Ajouter un primaire</button>

        <h3>Lycée – Premier cycle</h3>
        <div id="premierCycle"></div>
        <button class="btn-outline" onclick="addBlock('premierCycle')">+ Ajouter un 1er cycle</button>

        <h3>Lycée – Second cycle</h3>
        <div id="secondCycle"></div>
        <button class="btn-outline" onclick="addBlock('secondCycle')">+ Ajouter un 2nd cycle</button>

        <h3>Université / Institut</h3>
        <div id="universite"></div>
        <button class="btn-outline" onclick="addBlock('universite')">+ Ajouter une formation universitaire</button>

        <br><br>
        <button class="btn-outline" onclick="previousPage(2)">Retour</button>
        <button class="btn" onclick="nextPage(2)">Suivant</button>
    </div>

    <!-- PAGE 3 -->
    <div id="page3" class="page">
        <h2>Expériences professionnelles (facultatif)</h2>

        <div id="experiences"></div>
        <button class="btn-outline" onclick="addExperience()">+ Ajouter une expérience</button>

        <br><br>
        <button class="btn-outline" onclick="previousPage(3)">Retour</button>
        <button class="btn" onclick="nextPage(3)">Générer le CV</button>
    </div>

    <!-- PAGE 4 -->
    <div id="page4" class="page">
        <h2>Aperçu du CV</h2>
        <div id="cv-content" style="padding:15px; background:white; border:1px solid #ccc; border-radius:8px;"></div>

        <br>
        <button class="btn-outline" onclick="previousPage(4)">Retour</button>
        <button class="btn" onclick="downloadPDF()">Télécharger en PDF</button>
    </div>
</div>

<!-- HTML2PDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<script>
/* PAGE SYSTEM */
function nextPage(page){
    document.getElementById("page"+page).classList.remove("active");
    document.getElementById("page"+(page+1)).classList.add("active");
    if(page === 3){ generateCV(); }
}

function previousPage(page){
    document.getElementById("page"+page).classList.remove("active");
    document.getElementById("page"+(page-1)).classList.add("active");
}

/* ADD SCHOOL BLOCK */
function addBlock(section){
    let box = document.createElement("div");
    box.className = "block";

    box.innerHTML = `
        <button class="remove-item" onclick="this.parentNode.remove()">×</button>
        <div class="form-group"><label>Établissement</label><input class="etab"></div>
        <div class="form-group"><label>Ville</label><input class="ville"></div>
        <div class="form-group"><label>Année</label><input class="annee"></div>
    `;
    document.getElementById(section).appendChild(box);
}

/* EXPERIENCES */
function addExperience(){
    let box = document.createElement("div");
    box.className = "block";

    box.innerHTML = `
        <button class="remove-item" onclick="this.parentNode.remove()">×</button>
        <div class="form-group"><label>Poste occupé</label><input class="poste"></div>
        <div class="form-group"><label>Entreprise</label><input class="entre"></div>
        <div class="form-group"><label>Année</label><input class="anexp"></div>
    `;
    document.getElementById("experiences").appendChild(box);
}

/* GENERATE CV */
function generateCV(){
    let cv = document.getElementById("cv-content");
    cv.innerHTML = `
        <h1>${nom.value} ${prenoms.value}</h1>
        <p><b>Email :</b> ${email.value}</p>
        <p><b>Téléphone :</b> ${telephone.value}</p>
        <p><b>Adresse :</b> ${adresse.value}</p>
    `;

    function addSection(title, id){
        let items = document.querySelectorAll("#"+id+" .block");
        if(items.length === 0) return;

        cv.innerHTML += `<h2>${title}</h2>`;
        items.forEach(b => {
            cv.innerHTML += `
                <p><b>${b.querySelector(".etab").value}</b> – 
                ${b.querySelector(".ville").value} 
                (${b.querySelector(".annee").value})</p>
            `;
        });
    }

    addSection("École primaire", "primaire");
    addSection("Lycée – Premier cycle", "premierCycle");
    addSection("Lycée – Second cycle", "secondCycle");
    addSection("Université / Institut", "universite");

    /* EXPERIENCES */
    let exp = document.querySelectorAll("#experiences .block");
    if(exp.length > 0){
        cv.innerHTML += `<h2>Expériences professionnelles</h2>`;
        exp.forEach(e => {
            cv.innerHTML += `
                <p><b>${e.querySelector(".poste").value}</b> – 
                ${e.querySelector(".entre").value} 
                (${e.querySelector(".anexp").value})</p>
            `;
        });
    }
}

/* PDF */
function downloadPDF(){
    html2pdf().from(document.getElementById("cv-content")).save("MonCV.pdf");
}
</script>

</body>
</html>
